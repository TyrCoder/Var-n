<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Var√≥n ‚Äî Elegant Men's Fashion</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Commissioner:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
      /* Top Bar */
      .top-bar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 75px;
        background: #ffffff;
        border-bottom: 1px solid #f0f0f0;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 48px;
        z-index: 999;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        backdrop-filter: blur(10px);
      }

      /* Brand Logo */
      .top-brand {
        font-family: 'Playfair Display', serif;
        font-size: 28px;
        font-weight: 600;
        color: #000000;
        letter-spacing: 0.03em;
        margin-right: 48px;
        white-space: nowrap;
        cursor: pointer;
        transition: opacity 0.2s ease;
      }
      .top-brand:hover {
        opacity: 0.7;
      }

      /* Top Bar Left Section */
      .top-bar-left {
        display: flex;
        align-items: center;
        gap: 40px;
      }

      /* Top Navigation Links */
      .top-nav-links {
        display: flex;
        align-items: center;
        gap: 4px;
        list-style: none;
        margin: 0;
        padding: 0;
      }
      .top-nav-links li a {
        color: #737373;
        text-decoration: none;
        padding: 10px 16px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        display: block;
        position: relative;
      }
      .top-nav-links li a::after {
        content: '';
        position: absolute;
        bottom: 8px;
        left: 16px;
        right: 16px;
        height: 2px;
        background: #000;
        transform: scaleX(0);
        transition: transform 0.25s ease;
      }
      .top-nav-links li a:hover {
        color: #000000;
        background: #fafafa;
      }
      .top-nav-links li a:hover::after {
        transform: scaleX(1);
      }
      .top-nav-links li a.active {
        background: #000000;
        color: #ffffff;
      }
      .top-nav-links li a.active::after {
        display: none;
      }

      /* Top Bar Right Section */
      .top-bar-right {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      /* Login/Account Button */
      .account-button {
        background: #000000;
        border: 1px solid #000000;
        color: #ffffff;
        cursor: pointer;
        padding: 10px 24px;
        font-size: 14px;
        font-weight: 500;
        border-radius: 10px;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        text-decoration: none;
        display: inline-block;
        box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      }
      .account-button:hover {
        background: #1a1a1a;
        border-color: #1a1a1a;
        box-shadow: 0 4px 16px rgba(0,0,0,0.25);
        transform: translateY(-2px);
      }
      .account-button:active {
        transform: translateY(0);
      }

      /* Cart Button */
      .cart-button {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        color: #0a0a0a;
        cursor: pointer;
        padding: 8px 14px;
        font-size: 14px;
        font-weight: 500;
        border-radius: 8px;
        transition: all 0.2s ease;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 6px;
      }
      .cart-button:hover {
        background: #f9fafb;
        border-color: #d1d5db;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      }
      .cart-count {
        background: #0a0a0a;
        color: #fff;
        border-radius: 10px;
        padding: 2px 6px;
        font-size: 11px;
        font-weight: 600;
        min-width: 18px;
        text-align: center;
      }

      /* Adjust main content for fixed header */
      body {
        padding-top: 75px;
        background: #fafafa;
      }

      @media (max-width: 768px) {
        .top-bar {
          padding: 0 20px;
        }
        .top-bar-left {
          gap: 20px;
        }
        .top-brand {
          margin-right: 20px;
          font-size: 20px;
        }
        .top-nav-links {
          gap: 2px;
        }
        .top-nav-links li a {
          padding: 6px 10px;
          font-size: 13px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Top Bar with Brand, Navigation and Account Actions -->
    <div class="top-bar">
      <div class="top-bar-left">
        <div class="top-brand" onclick="showSection('home')">Var√≥n</div>
        <ul class="top-nav-links">
          <li><a href="javascript:void(0)" onclick="showSection('home')" class="active">Home</a></li>
          <li><a href="javascript:void(0)" onclick="showSection('browse')">Browse</a></li>
          <li><a href="javascript:void(0)" onclick="showSection('about')">About</a></li>
        </ul>
      </div>
      <div class="top-bar-right">
        <a href="{{ url_for('login') }}" class="account-button">Login</a>
      </div>
    </div>

    <!-- Hero Section -->
    <section class="hero" style="background:linear-gradient(135deg,#0a0a0a 0%,#1a1a1a 100%);min-height:60vh;display:flex;align-items:center;position:relative;overflow:hidden">
      <div class="hero-inner container" style="position:relative;z-index:1;max-width:1200px;margin:0 auto;padding:0 48px;width:100%">
        <div class="hero-copy" style="color:#fff;max-width:600px">
          <div style="margin-bottom:12px">
            <span style="font-size:12px;color:#999;font-weight:500;letter-spacing:2px;text-transform:uppercase">Curated Collection</span>
          </div>
          <h1 style="margin:0 0 16px;font-size:48px;font-weight:700;line-height:1.2;letter-spacing:-0.5px">Refined Elegance</h1>
          <p style="margin:0 0 24px;font-size:16px;color:#ccc;line-height:1.6">Sophisticated menswear crafted for the modern gentleman.</p>
          <div style="display:flex;gap:12px">
            <a href="javascript:void(0)" onclick="showSection('browse')" style="background:#fff;color:#0a0a0a;padding:11px 32px;border-radius:6px;text-decoration:none;font-weight:600;font-size:14px;transition:all 0.3s;display:inline-block" onmouseover="this.style.background='#f0f0f0'" onmouseout="this.style.background='#fff'">Shop Now</a>
            <a href="javascript:void(0)" onclick="showSection('about')" style="background:transparent;color:#fff;border:1px solid #fff;padding:11px 32px;border-radius:6px;text-decoration:none;font-weight:600;font-size:14px;transition:all 0.3s;display:inline-block" onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='transparent'">Learn More</a>
          </div>
        </div>
      </div>
    </section>

    <!-- Journal Section on Homepage -->
    <section id="journalSection" style="background:#fafafa;padding:60px 20px">
      <div class="container" style="max-width:1200px;margin:0 auto">
        <div style="text-align:center;margin-bottom:40px">
          <h2 style="margin:0 0 12px;font-size:32px;font-weight:600;color:#0a0a0a">Stories & Insights</h2>
          <p style="margin:0;font-size:14px;color:#666;max-width:400px;margin:12px auto 0">Fashion insights and style guides for the modern man.</p>
        </div>
        <div id="journalGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:24px">
        </div>
      </div>
    </section>

    <!-- Content Sections -->
    <div id="trackOrder" class="content-section" style="display:none">
      <div class="container" style="max-width:600px;margin:40px auto;padding:20px">
        <h2 style="margin-bottom:24px;text-align:center">Track Your Order</h2>
        <div style="background:#fff;padding:30px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1)">
          <form id="trackingForm" style="display:flex;flex-direction:column;gap:16px">
            <div>
              <label style="display:block;margin-bottom:8px;font-weight:500">Order Number</label>
              <input type="text" placeholder="Enter your order number" style="width:100%;padding:12px;border:1px solid #ddd;border-radius:6px">
            </div>
            <div>
              <label style="display:block;margin-bottom:8px;font-weight:500">Email</label>
              <input type="email" placeholder="Enter your email address" style="width:100%;padding:12px;border:1px solid #ddd;border-radius:6px">
            </div>
            <button type="submit" class="btn-cta" style="width:100%">Track Order</button>
          </form>
        </div>
      </div>
    </div>

    <div id="browse" class="content-section" style="display:block">
      <div class="container" style="margin-top:90px;padding-bottom:60px">
        <h2 style="margin:24px 0">Browse Collection</h2>

        <!-- Search Bar and Category Filter -->
        <div style="display:flex;gap:12px;margin-bottom:24px;align-items:center">
          <div style="flex:1;min-width:250px;position:relative">
            <input type="text" id="browseSearch" placeholder="Search products..." style="width:100%;padding:12px 16px;border:1px solid #ddd;border-radius:6px;font-size:14px;outline:none" onkeyup="handleBrowseSearch(event)">
            <span style="position:absolute;right:12px;top:50%;transform:translateY(-50%);color:#999;pointer-events:none">üîç</span>
          </div>
          <div style="min-width:220px">
            <select id="categoryDropdown" onchange="handleCategoryDropdown()" style="width:100%;padding:12px 16px;border:1px solid #ddd;border-radius:6px;font-size:14px;outline:none;cursor:pointer;background:#fff;appearance:none;background-image:url('data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"8\" viewBox=\"0 0 12 8\"><path fill=\"%23999\" d=\"M6 8L0 2h12z\"/></svg>');background-repeat:no-repeat;background-position:right 12px center;padding-right:36px">
              <option value="">All Categories</option>
            </select>
          </div>
        </div>

        <!-- Category Filter - Organized by Type -->
        <div id="categoriesContainer" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:24px;margin-bottom:40px">
          <!-- Categories will be loaded here organized by type -->
        </div>

        <div id="browseGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:20px">
          {% if products %}
            {% for product in products %}
              <a href="/product/{{ product.id }}" style="text-decoration:none;color:inherit">
                <article class="product" data-category="men" data-genre="{{ product.category_slug or 'all' }}" data-product-id="{{ product.id }}" style="background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,0.1);transition:transform 0.2s,box-shadow 0.2s;cursor:pointer" onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'" onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 1px 3px rgba(0,0,0,0.1)'">
                  <div class="product-image" style="position:relative;width:100%;height:280px;background:#f5f5f5;overflow:hidden">
                    <img src="{{ product.image_url or '/static/images/placeholder.svg' }}" alt="{{ product.name }}" style="width:100%;height:100%;object-fit:cover" onerror="this.src='/static/images/placeholder.svg'">
                  </div>
                  <div class="product-info" style="padding:16px">
                    <h3 style="margin:0 0 6px;font-size:15px;font-weight:500;color:#0a0a0a;line-height:1.3">{{ product.name }}</h3>
                    <div class="price" style="font-size:16px;font-weight:600;color:#0a0a0a">‚Ç±{{ "{:,.2f}".format(product.price) }}</div>
                  </div>
                </article>
              </a>
            {% endfor %}
          {% else %}
            <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px;">
              <h3 style="margin: 0 0 12px; color: #666;">No Products Available</h3>
              <p style="margin: 0; color: #999;">Check back soon for new arrivals!</p>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div id="about" class="content-section" style="display:none">
      <div class="container" style="max-width:800px;margin:40px auto;margin-top:90px;padding:20px">
        <h2 style="margin-bottom:24px;text-align:center">About Var√≥n</h2>
        <div style="background:#fff;padding:30px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.1)">
          <p style="line-height:1.6;margin:0 0 20px">Var√≥n is a modern menswear brand focused on creating timeless pieces that combine style, comfort, and sustainability. Our mission is to provide high-quality clothing that stands the test of time.</p>
          <p style="line-height:1.6;margin:0 0 20px">Founded in 2025, we've been dedicated to crafting minimal designs that emphasize quality materials and expert craftsmanship. Every piece in our collection is thoughtfully designed and responsibly made.</p>
          <p style="line-height:1.6;margin:0">Our commitment to sustainability and ethical fashion drives everything we do. We work closely with our partners to ensure responsible production methods and fair labor practices throughout our supply chain.</p>
        </div>
      </div>
    </div>


    <footer class="site-footer">
      <div class="footer-grid">
        <div>
          <h4>Var√≥n</h4>
          <p class="muted">Minimal, responsibly-made apparel. Clean silhouettes and timeless staples.</p>
        </div>
        <div>
          <h5>Shop</h5>
          <ul>
            <li><a href="#">All Products</a></li>
            <li><a href="#">New Arrivals</a></li>
            <li><a href="#">Best Sellers</a></li>
          </ul>
        </div>
        <div>
          <h5>Genres</h5>
          <ul>
            <li><a href="#">Tops</a></li>
            <li><a href="#">Bottoms</a></li>
            <li><a href="#">Outerwear</a></li>
            <li><a href="#">Accessories</a></li>
          </ul>
        </div>
        <div>
          <h5>Partners</h5>
          <ul>
            <li><a href="{{ url_for('signup_seller') }}" id="footerSeller">Register as a seller</a></li>
            <li><a href="{{ url_for('signup_rider') }}" id="footerRider">Register as a rider</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <div class="footer-brand">Var√≥n ‚Äî Minimal Apparel</div>
        <small>¬© <span class="muted">2025</span></small>
      </div>
    </footer>




    <script src="{{ url_for('static', filename='js/script.js') }}?v=3"></script>
    <div id="snackbar" class="snackbar" role="status" aria-live="polite">Added to cart</div>

    <div class="overlay" id="overlay"></div>
    <aside class="sidebar" id="sidebar">
      <nav class="sidebar-nav">
        <a href="{{ url_for('login') }}">Track Your Order</a>
        <a href="javascript:void(0)" onclick="showSection('browse')">Browse</a>
        <a href="javascript:void(0)" onclick="showSection('about')">About</a>
        <a href="{{ url_for('login') }}" class="account">Login</a>
        <a href="{{ url_for('login') }}" class="account">Cart <span id="cartCountSidebar">0</span></a>
      </nav>
    </aside>

    <!-- Main Content -->
    <div id="loginSection" class="content-section" style="display:none">
      <div class="auth-content">
        <!-- Login Form -->
        <form id="loginForm" class="auth-form active" action="{{ url_for('login') }}" method="POST">
          <div class="auth-tabs-inner">
            <div class="tab-link active">Login</div>
            <div class="tab-link">Sign Up</div>
          </div>
          <h2 class="auth-title">Welcome Back</h2>
          <p class="auth-subtitle">Enter your credentials to access your account</p>

          <div class="form-group">
            <label class="form-label" for="loginEmail">
              <svg class="form-icon" viewBox="0 0 24 24">
                <path fill="currentColor" d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"/>
              </svg>
              Email Address
            </label>
            <input id="loginEmail" class="form-input" name="email" type="email" placeholder="admin@varon.local" required />
          </div>

          <div class="form-group">
            <label class="form-label" for="loginPassword">
              <svg class="form-icon" viewBox="0 0 24 24">
                <path fill="currentColor" d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"/>
              </svg>
              Password
            </label>
            <div class="password-wrapper">
              <input id="loginPassword" class="form-input" name="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
              <button type="button" class="toggle-password" onclick="togglePassword('loginPassword', this)" aria-label="Toggle password visibility">
                <svg viewBox="0 0 24 24" width="20" height="20">
                  <path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
                </svg>
              </button>
            </div>
          </div>

          <button type="submit" class="btn-submit">Login to Your Account</button>

          <div class="form-footer">
            <a href="#" onclick="event.preventDefault(); openForgotPasswordModal(); return false;" class="forgot-link">Forgot your password?</a>
          </div>
        </form>
      </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal" aria-hidden="true">
      <div class="cart-card">
        <button onclick="closeModal('cartModal')" class="cart-close-btn" aria-label="Close cart">√ó</button>
        <h2 style="text-align:left;margin-bottom:20px">Your Cart</h2>
        <div id="cartList" class="cart-list">
          <!-- Empty cart state -->
          <div class="empty-cart-state" style="text-align:center;padding:60px 20px">
            <div style="font-size:80px;color:#ddd;margin-bottom:16px">
              <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" style="display:inline-block">
                <path d="M9 2L7.17 4H3c-.55 0-1 .45-1 1s.45 1 1 1h1l1.6 8.6c.18 1 1.05 1.73 2.06 1.73h7.72c1.01 0 1.88-.73 2.06-1.73L19 6h1c.55 0 1-.45 1-1s-.45-1-1-1h-4.17L14 2H9z"/>
                <circle cx="9" cy="20" r="1"/>
                <circle cx="16" cy="20" r="1"/>
              </svg>
            </div>
            <h3 style="font-size:18px;font-weight:400;color:#999;margin:0 0 8px">Your cart is empty</h3>
            <p style="font-size:14px;color:#bbb;margin:0">Add some products to get started!</p>
          </div>
        </div>
        <div class="cart-totals">
          <div style="padding:24px 0;border-top:1px solid #eee">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
              <span style="color:#666;font-size:15px">Subtotal:</span>
              <span style="font-size:16px;font-weight:500" id="cartSubtotal">‚Ç±0.00</span>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:24px">
              <span style="font-size:18px;font-weight:600;color:#0a0a0a">Total:</span>
              <span style="font-size:20px;font-weight:600;color:#0a0a0a" id="cartTotal">‚Ç±0.00</span>
            </div>
          </div>
          <div style="display:flex;gap:12px">
            <button onclick="clearCart()" class="btn-secondary" style="flex:1;padding:14px;font-size:15px;font-weight:500;border-radius:6px;border:1px solid #e0e0e0;background:#fff;color:#0a0a0a;cursor:pointer;transition:all 0.2s" onmouseover="this.style.background='#f8f8f8'" onmouseout="this.style.background='#fff'">CLEAR CART</button>
            <button id="checkoutBtn" class="btn-cta" style="flex:1;padding:14px;font-size:15px;font-weight:500;border-radius:6px;background:#0a0a0a;color:#fff;border:none;cursor:pointer;transition:all 0.2s" onmouseover="this.style.background='#2d2d2d'" onmouseout="this.style.background='#0a0a0a'">PROCEED TO CHECKOUT</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Confirm Clear Cart Modal -->
    <div id="clearModal" class="modal" aria-hidden="true">
      <div class="modal-panel">
        <button class="modal-close" onclick="closeModal('clearModal')">√ó</button>
        <h2 style="margin:0 0 8px">Clear Cart?</h2>
        <p style="margin:0 0 18px;color:var(--muted)">Are you sure you want to remove all items from your cart?</p>
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button onclick="closeModal('clearModal')" class="btn-cta" style="background:#f6f6f6;color:#0a0a0a">Cancel</button>
          <button id="confirmClearYes" class="btn-cta">Yes, Clear Cart</button>
        </div>
      </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="modal" aria-hidden="true">
      <div class="modal-panel checkout">
        <button class="modal-close" onclick="closeModal('checkoutModal')" style="color:#fff">√ó</button>
        <h2 style="color:#fff;margin:0 0 8px">Checkout</h2>
        <p class="muted" style="margin:0 0 18px">Review your order before proceeding to payment</p>
        <div id="checkoutSummary" style="margin-bottom:18px"></div>
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button onclick="closeModal('checkoutModal')" class="secondary">Cancel</button>
          <button id="proceedCheckout" class="btn-cta">Proceed to Payment</button>
        </div>
      </div>
    </div>

    <script>

      function showSection(sectionName) {

        document.querySelectorAll('.content-section').forEach(section => {
          section.style.display = 'none';
        });


        const heroSection = document.querySelector('.hero');
        const journalSection = document.getElementById('journalSection');


        if (sectionName === 'home') {

          if (heroSection) heroSection.style.display = 'block';
          if (journalSection) journalSection.style.display = 'block';
        } else {

          if (heroSection) heroSection.style.display = 'none';
          if (journalSection) journalSection.style.display = 'none';


          const targetSection = document.getElementById(sectionName);
          if (targetSection) {
            targetSection.style.display = 'block';
          }
        }


        if (sectionName === 'browse') {
          loadBrowseProducts();
        }


        document.querySelectorAll('.top-nav-links a').forEach(link => {
          link.classList.remove('active');
        });
        const activeLink = document.querySelector(`.top-nav-links a[onclick*="${sectionName}"]`);
        if (activeLink) {
          activeLink.classList.add('active');
        }
      }


      function getColorBackground(colorName) {
        const colorHex = {
          'Black': '#000000', 'White': '#FFFFFF', 'Gray': '#808080', 'Grey': '#808080',
          'Navy': '#000080', 'Blue': '#0000FF', 'Red': '#FF0000', 'Pink': '#FFC0CB',
          'Green': '#008000', 'Brown': '#8B4513', 'Beige': '#F5F5DC', 'Cream': '#FFFDD0',
          'Khaki': '#C3B091', 'Burgundy': '#800020', 'Olive': '#808000', 'Orange': '#FF8C00',
          'Charcoal': '#36454F', 'Yellow': '#FFD700', 'Purple': '#800080', 'Violet': '#8B00FF',
          'Maroon': '#800000', 'Tan': '#D2B48C', 'Ivory': '#FFFFF0', 'Silver': '#C0C0C0',
          'Gold': '#FFD700', 'Indigo': '#4B0082', 'Teal': '#008080', 'Cyan': '#00FFFF'
        };


        if (colorName.includes('/')) {
          const colors = colorName.split('/').map(c => c.trim());
          const gradientColors = colors.map(c => {
            let hex = colorHex[c];
            if (!hex) {
              const colorLower = c.toLowerCase();
              for (const [key, value] of Object.entries(colorHex)) {
                if (key.toLowerCase().includes(colorLower) || colorLower.includes(key.toLowerCase())) {
                  hex = value;
                  break;
                }
              }
            }
            if (!hex) hex = '#' + c.split('').reduce((acc, char) => ((acc << 5) - acc + char.charCodeAt(0)).toString(16).substr(0, 6).padEnd(6, '0'), 0).substr(0, 6);
            return hex;
          });

          if (colors.length === 2) {
            return `linear-gradient(135deg, ${gradientColors[0]} 50%, ${gradientColors[1]} 50%)`;
          } else if (colors.length === 3) {
            return `linear-gradient(135deg, ${gradientColors[0]} 33%, ${gradientColors[1]} 33%, ${gradientColors[1]} 66%, ${gradientColors[2]} 66%)`;
          } else {
            const percentPerColor = 100 / colors.length;
            let gradient = 'linear-gradient(135deg';
            gradientColors.forEach((hex, i) => {
              gradient += `, ${hex} ${i * percentPerColor}%, ${hex} ${(i + 1) * percentPerColor}%`;
            });
            gradient += ')';
            return gradient;
          }
        } else {

          let hex = colorHex[colorName];
          if (!hex) {
            const colorLower = colorName.toLowerCase();
            for (const [key, value] of Object.entries(colorHex)) {
              if (key.toLowerCase().includes(colorLower) || colorLower.includes(key.toLowerCase())) {
                hex = value;
                break;
              }
            }
          }
          if (!hex) hex = '#' + colorName.split('').reduce((acc, char) => ((acc << 5) - acc + char.charCodeAt(0)).toString(16).substr(0, 6).padEnd(6, '0'), 0).substr(0, 6);
          return hex;
        }
      }



      function loadCategories() {
        fetch('/api/categories')
          .then(response => response.json())
          .then(data => {
            if (data.success && data.categories) {
              const categoriesContainer = document.getElementById('categoriesContainer');
              if (categoriesContainer) {
                categoriesContainer.innerHTML = '';


                const allSection = document.createElement('div');
                allSection.style.cssText = 'background:#fff;border:1px solid #e5e7eb;border-radius:8px;padding:16px;text-align:center;cursor:pointer;transition:all 0.2s';

                const allTitle = document.createElement('h3');
                allTitle.style.cssText = 'margin:0;font-size:14px;font-weight:600;color:#0a0a0a;text-transform:uppercase;letter-spacing:0.5px';
                allTitle.textContent = 'All';
                allSection.appendChild(allTitle);

                const allLink = document.createElement('a');
                allLink.href = 'javascript:void(0)';
                allLink.setAttribute('data-category', '');
                allLink.style.cssText = 'color:#666;text-decoration:none;font-size:13px;display:block;margin-top:8px;font-weight:600;color:#0a0a0a';
                allLink.textContent = 'View All';
                allLink.onclick = (e) => {
                  e.preventDefault();
                  handleCategoryFilter(e, '');
                };
                allSection.appendChild(allLink);

                allSection.onmouseover = () => {
                  allSection.style.background = '#fafafa';
                  allSection.style.borderColor = '#d1d5db';
                };
                allSection.onmouseout = () => {
                  allSection.style.background = '#fff';
                  allSection.style.borderColor = '#e5e7eb';
                };

                categoriesContainer.appendChild(allSection);


                const categoriesByType = {};
                data.categories.forEach(category => {
                  const type = category.category_type || 'OTHER';
                  if (!categoriesByType[type]) {
                    categoriesByType[type] = [];
                  }
                  categoriesByType[type].push(category);
                });


                const typeOrder = ['TOPS', 'BOTTOMS', 'FOOTWEAR', 'ACCESSORIES', 'GROOMING PRODUCTS'];


                typeOrder.forEach((type, typeIndex) => {
                  if (categoriesByType[type]) {
                    const typeSection = document.createElement('div');
                    typeSection.style.cssText = 'background:#fff;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;transition:all 0.2s';

                    const typeHeader = document.createElement('div');
                    typeHeader.style.cssText = 'display:flex;justify-content:space-between;align-items:center;cursor:pointer;user-select:none;padding:16px;background:#fafafa;border-bottom:1px solid #e5e7eb;transition:background 0.2s';

                    const typeTitle = document.createElement('h3');
                    typeTitle.style.cssText = 'margin:0;font-size:14px;font-weight:600;color:#0a0a0a;text-transform:uppercase;letter-spacing:0.5px';
                    typeTitle.textContent = type;
                    typeHeader.appendChild(typeTitle);

                    const toggleIcon = document.createElement('span');
                    toggleIcon.style.cssText = 'font-size:14px;color:#0a0a0a;transition:transform 0.3s;transform:rotate(90deg);display:block;width:16px;text-align:center';
                    toggleIcon.textContent = '‚ñ∂';
                    typeHeader.appendChild(toggleIcon);

                    typeSection.appendChild(typeHeader);

                    const categoryList = document.createElement('div');
                    categoryList.style.cssText = 'display:grid;grid-template-columns:1fr;gap:0;padding:12px 16px;background:#fff';

                    let isExpanded = typeIndex === 0;

                    categoriesByType[type].forEach(category => {
                      const link = document.createElement('a');
                      link.href = 'javascript:void(0)';
                      link.setAttribute('data-category', category.id);
                      link.style.cssText = 'color:#666;text-decoration:none;font-size:13px;padding:8px 0;border-bottom:1px solid #f3f4f6;transition:all 0.2s;cursor:pointer;display:block';
                      link.textContent = category.name;
                      link.onmouseover = () => {
                        link.style.color = '#0a0a0a';
                        link.style.paddingLeft = '6px';
                        link.style.fontWeight = '500';
                      };
                      link.onmouseout = () => {
                        link.style.color = '#666';
                        link.style.paddingLeft = '0';
                        link.style.fontWeight = '400';
                      };
                      link.onclick = (e) => {
                        e.preventDefault();
                        handleCategoryFilter(e, category.id);
                      };
                      categoryList.appendChild(link);
                    });

                    typeSection.appendChild(categoryList);


                    typeHeader.onclick = () => {
                      isExpanded = !isExpanded;
                      if (isExpanded) {
                        categoryList.style.display = 'grid';
                        toggleIcon.style.transform = 'rotate(-90deg)';
                        typeHeader.style.background = '#f0f0f0';
                      } else {
                        categoryList.style.display = 'none';
                        toggleIcon.style.transform = 'rotate(90deg)';
                        typeHeader.style.background = '#fafafa';
                      }
                    };

                    typeHeader.onmouseover = () => {
                      typeHeader.style.background = '#f0f0f0';
                    };
                    typeHeader.onmouseout = () => {
                      typeHeader.style.background = isExpanded ? '#f0f0f0' : '#fafafa';
                    };

                    if (!isExpanded) {
                      categoryList.style.display = 'none';
                    }

                    typeSection.onmouseover = () => {
                      typeSection.style.borderColor = '#d1d5db';
                      typeSection.style.boxShadow = '0 2px 4px rgba(0,0,0,0.05)';
                    };
                    typeSection.onmouseout = () => {
                      typeSection.style.borderColor = '#e5e7eb';
                      typeSection.style.boxShadow = 'none';
                    };

                    categoriesContainer.appendChild(typeSection);
                  }
                });

                // Populate dropdown
                const dropdown = document.getElementById('categoryDropdown');
                if (dropdown) {
                  // Clear existing options except first
                  dropdown.innerHTML = '<option value="">All Categories</option>';
                  
                  // Add categories grouped by type
                  typeOrder.forEach(type => {
                    if (categoriesByType[type]) {
                      const optgroup = document.createElement('optgroup');
                      optgroup.label = type;
                      categoriesByType[type].forEach(category => {
                        const option = document.createElement('option');
                        option.value = category.id;
                        option.textContent = category.name;
                        optgroup.appendChild(option);
                      });
                      dropdown.appendChild(optgroup);
                    }
                  });
                }
              }
            }
          })
          .catch(error => {
            console.error('Error fetching categories:', error);
          });
      }

      function handleCategoryDropdown() {
        const dropdown = document.getElementById('categoryDropdown');
        const categoryId = dropdown.value;
        
        // Create fake event for handleCategoryFilter
        const fakeEvent = { preventDefault: () => {} };
        handleCategoryFilter(fakeEvent, categoryId);
      }


      let searchTimeout;
      function handleBrowseSearch(event) {
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
          loadBrowseProducts();
        }, 300);
      }


      function handleCategoryFilter(event, categoryId) {
        event.preventDefault();


        const allLinks = document.querySelectorAll('#categoriesContainer a');
        allLinks.forEach(link => {
          if (link.getAttribute('data-category') == categoryId) {
            link.style.color = '#0a0a0a';
            link.style.fontWeight = '600';
            link.style.paddingLeft = '8px';
          } else {
            link.style.color = '#666';
            link.style.fontWeight = '400';
            link.style.paddingLeft = '0';
          }
        });


        loadBrowseProducts(categoryId);
      }

      function loadBrowseProducts(categoryId) {
        const searchInput = document.getElementById('browseSearch');

        const search = searchInput ? searchInput.value.trim() : '';

        let selectedCategoryId = categoryId;
        if (selectedCategoryId === undefined) {
          const activeLink = document.querySelector('#categoriesContainer a[style*="font-weight: 600"]') || document.querySelector('#categoriesContainer a[style*="fontWeight: 600"]');
          selectedCategoryId = activeLink ? activeLink.getAttribute('data-category') : '';
        }


        const params = new URLSearchParams();
        if (search) params.append('search', search);
        if (selectedCategoryId) params.append('category_id', selectedCategoryId);
        params.append('limit', '50');

        fetch(`/api/products?${params.toString()}`)
          .then(response => response.json())
          .then(data => {
            const browseGrid = document.getElementById('browseGrid');
            if (!browseGrid) return;

            if (data.success && data.products && data.products.length > 0) {
              console.log('Loaded products:', data.products);
              browseGrid.innerHTML = data.products.map(product => {
                const colorSwatches = product.colors && product.colors.length > 0
                  ? `<div style="display:flex;gap:4px;margin-top:8px;flex-wrap:wrap;">
                      ${product.colors.slice(0, 5).map(color => `
                        <div style="width:20px;height:20px;border-radius:50%;background:${getColorBackground(color)};border:1px solid #e0e0e0;" title="${color}"></div>
                      `).join('')}
                      ${product.colors.length > 5 ? `<span style="font-size:11px;color:#999;align-self:center;">+${product.colors.length - 5}</span>` : ''}
                    </div>`
                  : '';

                const hasPromotion = product.promotion && product.discount_display;
                const priceDisplay = hasPromotion
                  ? `<div style="display:flex;gap:8px;align-items:center">
                      <span style="text-decoration:line-through;color:#999;font-size:14px">‚Ç±${parseFloat(product.original_price).toFixed(2)}</span>
                      <span style="font-size:16px;font-weight:600;color:#0a0a0a">‚Ç±${parseFloat(product.price_to_display).toFixed(2)}</span>
                      <span style="background:#ff4444;color:white;padding:2px 6px;border-radius:4px;font-size:12px;font-weight:600">${product.discount_display}</span>
                    </div>`
                  : `<p style="margin:0;color:#666;font-size:14px">‚Ç±${parseFloat(product.price).toFixed(2)}</p>`;

                return `
                  <div style="background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 4px rgba(0,0,0,0.1);cursor:pointer;transition:transform 0.2s"
                       onclick="if (!isUserLoggedIn) { window.location.href='/login'; } else { window.location.href='/product/${product.id}'; }"
                       onmouseover="this.style.transform='translateY(-4px)'"
                       onmouseout="this.style.transform='translateY(0)'">
                    <div style="height:200px;background:#f5f5f5;background-image:url('${product.image_url || 'https://images.unsplash.com/photo-1495121605193-b116b5b09f06?q=80&w=800&auto=format&fit=crop'}');background-size:cover;background-position:center"></div>
                    <div style="padding:16px">
                      <h3 style="margin:0 0 8px;font-size:16px;font-weight:600;line-height:1.3">${product.name}</h3>
                      ${priceDisplay}
                      ${colorSwatches}
                    </div>
                  </div>
                `;
              }).join('');
            } else {
              browseGrid.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px;">
                  <h3 style="margin: 0 0 12px; color: #666;">No Products Found</h3>
                  <p style="margin: 0; color: #999;">Try adjusting your search or filter criteria.</p>
                </div>
              `;
            }
          })
          .catch(error => {
            console.error('Error fetching products:', error);
            const browseGrid = document.getElementById('browseGrid');
            if (browseGrid) {
              browseGrid.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px;">
                  <h3 style="margin: 0 0 12px; color: #ef4444;">Error Loading Products</h3>
                  <p style="margin: 0; color: #999;">Please try again later.</p>
                </div>
              `;
            }
          });
      }


      const isUserLoggedIn = {{ 'true' if session.get('logged_in') else 'false' }};


      const originalAddToCart = window.addToCart;
      window.addToCart = function(name, price, id, quantity = 1) {

        if (!isUserLoggedIn) {
          alert('You need to log in to add items to cart');
          window.location.href = '/login';
          return;
        }

        for (let i = 0; i < quantity; i++) {
          if (originalAddToCart) {
            originalAddToCart(name, price, id);
          }
        }
      };


      function loadJournalEntries() {
        fetch('/api/journal-entries')
          .then(response => response.json())
          .then(data => {
            const journalGrid = document.getElementById('journalGrid');
            if (data.success && data.entries && data.entries.length > 0) {
              journalGrid.innerHTML = data.entries.map(entry => `
                <article style="background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.08);transition:all 0.2s ease;cursor:pointer;display:flex;flex-direction:column;height:100%"
                         onmouseover="this.style.transform='translateY(-4px)';this.style.boxShadow='0 8px 20px rgba(0,0,0,0.12)'"
                         onmouseout="this.style.transform='translateY(0)';this.style.boxShadow='0 2px 8px rgba(0,0,0,0.08)'"
                         ${entry.link_url ? `onclick="window.open('${entry.link_url}', '_blank')"` : ''}>
                  <div style="height:180px;background:#f5f5f5;background-image:url('${entry.image_url || 'https://images.unsplash.com/photo-1521334884684-d80222895322?q=80&w=800&auto=format&fit=crop'}');background-size:cover;background-position:center"></div>
                  <div style="padding:20px;display:flex;flex-direction:column;flex:1">
                    <h3 style="margin:0 0 8px;font-size:16px;font-weight:600;color:#0a0a0a;line-height:1.3">${entry.title}</h3>
                    <p style="margin:0 0 12px;color:#666;line-height:1.5;font-size:13px;flex:1">${entry.description || ''}</p>
                    ${entry.link_url ? '<a href="' + entry.link_url + '" target="_blank" style="color:#0a0a0a;text-decoration:none;font-weight:500;font-size:13px;transition:all 0.2s">Read More ‚Üí</a>' : ''}
                  </div>
                </article>
              `).join('');
            } else {
              journalGrid.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:40px 20px"><p style="margin:0;color:#999;font-size:14px">No journal entries available yet.</p></div>';
            }
          })
          .catch(error => {
            console.error('Error loading journal entries:', error);
            const journalGrid = document.getElementById('journalGrid');
            journalGrid.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:40px 20px"><p style="margin:0;color:#999;font-size:14px">No journal entries available yet.</p></div>';
          });
      }


      document.addEventListener('DOMContentLoaded', function() {
        loadJournalEntries();
        setupOTPInputs();


        loadCategories();


        loadBrowseProducts();


        document.querySelectorAll('.product').forEach(product => {
          product.addEventListener('click', function(e) {

            if (e.target.classList.contains('add-to-cart')) return;

            const productId = this.getAttribute('data-product-id');
            if (productId && !isUserLoggedIn) {

              window.location.href = '/login';
            } else if (productId) {
              showProductDetail(productId);
            }
          });


          const image = product.querySelector('.product-image');
          const info = product.querySelector('.product-info');
          if (image) image.style.cursor = 'pointer';
          if (info) info.style.cursor = 'pointer';
        });


        document.querySelectorAll('.add-to-cart').forEach(btn => {
          btn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();


            alert('You need to log in to add items to cart');
            window.location.href = '/login';
          });
        });
      });


      let currentForgotPasswordStep = 1;
      let forgotPasswordEmail = '';

      function openForgotPasswordModal() {
        document.getElementById('forgotPasswordModal').style.display = 'flex';
        resetForgotPasswordModal();

        setTimeout(() => {
          setupOTPInputs();
        }, 100);
      }

      function closeForgotPasswordModal() {
        document.getElementById('forgotPasswordModal').style.display = 'none';
        resetForgotPasswordModal();
      }

      function resetForgotPasswordModal() {
        currentForgotPasswordStep = 1;
        forgotPasswordEmail = '';
        document.getElementById('fpStep1').style.display = 'block';
        document.getElementById('fpStep2').style.display = 'none';
        document.getElementById('fpStep3').style.display = 'none';
        document.getElementById('fpEmail').value = '';
        document.querySelectorAll('.fp-otp-input').forEach(input => input.value = '');
        document.getElementById('fpNewPassword').value = '';
        document.getElementById('fpConfirmPassword').value = '';
        document.getElementById('fpErrorMessage').style.display = 'none';
        document.getElementById('fpSuccessMessage').style.display = 'none';
      }

      function showForgotPasswordError(message) {
        const errorEl = document.getElementById('fpErrorMessage');
        errorEl.textContent = message;
        errorEl.style.display = 'block';
        document.getElementById('fpSuccessMessage').style.display = 'none';
      }

      function showForgotPasswordSuccess(message) {
        const successEl = document.getElementById('fpSuccessMessage');
        successEl.textContent = message;
        successEl.style.display = 'block';
        document.getElementById('fpErrorMessage').style.display = 'none';
      }

      async function requestPasswordReset(e) {
        e.preventDefault();
        const email = document.getElementById('fpEmail').value.trim();

        if (!email) {
          showForgotPasswordError('Please enter your email address');
          return;
        }

        const btn = e.target.querySelector('button[type="submit"]');
        const originalText = btn.textContent;
        btn.disabled = true;
        btn.textContent = 'Sending OTP...';

        try {
          const response = await fetch('/forgot-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email })
          });

          const data = await response.json();

          if (data.success) {
            forgotPasswordEmail = email;
            showForgotPasswordSuccess(data.message || 'OTP sent successfully');
            setTimeout(() => {
              document.getElementById('fpStep1').style.display = 'none';
              document.getElementById('fpStep2').style.display = 'block';
              currentForgotPasswordStep = 2;
              document.getElementById('fpSuccessMessage').style.display = 'none';
            }, 1500);
          } else {
            showForgotPasswordError(data.message || data.error || 'An error occurred');
          }
        } catch (error) {
          showForgotPasswordError('Network error. Please try again.');
        } finally {
          btn.disabled = false;
          btn.textContent = originalText;
        }
      }

      async function verifyResetOTP(e) {
        e.preventDefault();
        const otpInputs = document.querySelectorAll('.fp-otp-input');
        const otp = Array.from(otpInputs).map(input => input.value).join('');

        if (otp.length !== 6) {
          showForgotPasswordError('Please enter the complete 6-digit code');
          return;
        }

        const btn = e.target.querySelector('button[type="submit"]');
        const originalText = btn.textContent;
        btn.disabled = true;
        btn.textContent = 'Verifying...';

        try {
          const response = await fetch('/verify-reset-otp', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email: forgotPasswordEmail, otp })
          });

          const data = await response.json();

          if (data.success) {
            showForgotPasswordSuccess('OTP verified! Please set your new password.');
            setTimeout(() => {
              document.getElementById('fpStep2').style.display = 'none';
              document.getElementById('fpStep3').style.display = 'block';
              currentForgotPasswordStep = 3;
              document.getElementById('fpSuccessMessage').style.display = 'none';
            }, 1500);
          } else {
            showForgotPasswordError(data.message || data.error || 'Invalid OTP');
          }
        } catch (error) {
          showForgotPasswordError('Network error. Please try again.');
        } finally {
          btn.disabled = false;
          btn.textContent = originalText;
        }
      }

      async function resetPassword(e) {
        e.preventDefault();
        const newPassword = document.getElementById('fpNewPassword').value;
        const confirmPassword = document.getElementById('fpConfirmPassword').value;

        if (!newPassword || !confirmPassword) {
          showForgotPasswordError('Please fill in both password fields');
          return;
        }

        if (newPassword !== confirmPassword) {
          showForgotPasswordError('Passwords do not match');
          return;
        }

        if (newPassword.length < 6) {
          showForgotPasswordError('Password must be at least 6 characters');
          return;
        }

        if (!/[a-zA-Z]/.test(newPassword) || !/[0-9]/.test(newPassword)) {
          showForgotPasswordError('Password must contain both letters and numbers');
          return;
        }

        const btn = e.target.querySelector('button[type="submit"]');
        const originalText = btn.textContent;
        btn.disabled = true;
        btn.textContent = 'Resetting...';

        try {
          const response = await fetch('/reset-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ new_password: newPassword })
          });

          const data = await response.json();

          if (data.success) {
            showForgotPasswordSuccess('Password reset successful! Redirecting to login...');
            setTimeout(() => {
              closeForgotPasswordModal();
              window.location.reload();
            }, 2000);
          } else {
            showForgotPasswordError(data.message || data.error || 'Password reset failed');
          }
        } catch (error) {
          showForgotPasswordError('Network error. Please try again.');
        } finally {
          btn.disabled = false;
          btn.textContent = originalText;
        }
      }

      async function resendResetOTP() {
        const btn = document.getElementById('fpResendBtn');
        const originalText = btn.textContent;
        btn.disabled = true;
        btn.textContent = 'Sending...';

        try {
          const response = await fetch('/forgot-password', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email: forgotPasswordEmail })
          });

          const data = await response.json();

          if (data.success) {
            showForgotPasswordSuccess('New OTP sent to your email!');
            setTimeout(() => {
              document.getElementById('fpSuccessMessage').style.display = 'none';
            }, 3000);
          } else {
            showForgotPasswordError(data.message || data.error || 'Failed to resend OTP');
          }
        } catch (error) {
          showForgotPasswordError('Network error. Please try again.');
        } finally {
          btn.disabled = false;
          btn.textContent = originalText;
        }
      }


      function setupOTPInputs() {
        const inputs = document.querySelectorAll('.fp-otp-input');
        inputs.forEach((input, index) => {
          input.addEventListener('input', (e) => {
            if (e.target.value.length === 1 && index < inputs.length - 1) {
              inputs[index + 1].focus();
            }
          });
          input.addEventListener('keydown', (e) => {
            if (e.key === 'Backspace' && !e.target.value && index > 0) {
              inputs[index - 1].focus();
            }
          });
        });
      }
    </script>

    <!-- Forgot Password Modal -->
    <div id="forgotPasswordModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; align-items: center; justify-content: center;">
      <div style="background: white; border-radius: 20px; padding: 40px; max-width: 500px; width: 90%; position: relative; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
        <button onclick="closeForgotPasswordModal()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>

        <h2 style="font-family: 'Playfair Display', serif; font-size: 28px; margin-bottom: 10px; color: #0a0a0a;">Reset Password</h2>
        <p style="color: #777; margin-bottom: 30px; font-size: 14px;">Follow the steps to reset your password</p>

        <!-- Error/Success Messages -->
        <div id="fpErrorMessage" style="display: none; background: #fde8e8; color: #dc3545; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 14px;"></div>
        <div id="fpSuccessMessage" style="display: none; background: #d1e7dd; color: #198754; padding: 12px; border-radius: 8px; margin-bottom: 20px; font-size: 14px;"></div>

        <!-- Step 1: Enter Email -->
        <form id="fpStep1" onsubmit="requestPasswordReset(event)">
          <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 500; margin-bottom: 8px; color: #0a0a0a; font-size: 14px;">Email Address</label>
            <input type="email" id="fpEmail" required style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; font-family: 'Commissioner', sans-serif;" placeholder="Enter your email">
          </div>
          <button type="submit" style="width: 100%; padding: 14px; background: #0a0a0a; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 500; cursor: pointer; font-family: 'Commissioner', sans-serif;">Send Reset Code</button>
        </form>

        <!-- Step 2: Enter OTP -->
        <form id="fpStep2" style="display: none;" onsubmit="verifyResetOTP(event)">
          <p style="color: #666; margin-bottom: 20px; font-size: 14px;">Enter the 6-digit code sent to your email</p>
          <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;">
            <input type="text" class="fp-otp-input" maxlength="1" required style="width: 50px; height: 50px; text-align: center; font-size: 24px; border: 2px solid #ddd; border-radius: 8px; font-family: 'Commissioner', sans-serif;">
            <input type="text" class="fp-otp-input" maxlength="1" required style="width: 50px; height: 50px; text-align: center; font-size: 24px; border: 2px solid #ddd; border-radius: 8px; font-family: 'Commissioner', sans-serif;">
            <input type="text" class="fp-otp-input" maxlength="1" required style="width: 50px; height: 50px; text-align: center; font-size: 24px; border: 2px solid #ddd; border-radius: 8px; font-family: 'Commissioner', sans-serif;">
            <input type="text" class="fp-otp-input" maxlength="1" required style="width: 50px; height: 50px; text-align: center; font-size: 24px; border: 2px solid #ddd; border-radius: 8px; font-family: 'Commissioner', sans-serif;">
            <input type="text" class="fp-otp-input" maxlength="1" required style="width: 50px; height: 50px; text-align: center; font-size: 24px; border: 2px solid #ddd; border-radius: 8px; font-family: 'Commissioner', sans-serif;">
            <input type="text" class="fp-otp-input" maxlength="1" required style="width: 50px; height: 50px; text-align: center; font-size: 24px; border: 2px solid #ddd; border-radius: 8px; font-family: 'Commissioner', sans-serif;">
          </div>
          <button type="submit" style="width: 100%; padding: 14px; background: #0a0a0a; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 500; cursor: pointer; margin-bottom: 10px; font-family: 'Commissioner', sans-serif;">Verify Code</button>
          <button type="button" id="fpResendBtn" onclick="resendResetOTP()" style="width: 100%; padding: 12px; background: transparent; color: #0a0a0a; border: 1px solid #0a0a0a; border-radius: 8px; font-size: 14px; cursor: pointer; font-family: 'Commissioner', sans-serif;">Resend Code</button>
        </form>

        <!-- Step 3: New Password -->
        <form id="fpStep3" style="display: none;" onsubmit="resetPassword(event)">
          <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 500; margin-bottom: 8px; color: #0a0a0a; font-size: 14px;">New Password</label>
            <div style="position: relative;">
              <input type="password" id="fpNewPassword" required style="width: 100%; padding: 12px; padding-right: 45px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; font-family: 'Commissioner', sans-serif;" placeholder="Enter new password">
              <button type="button" onclick="togglePasswordVisibility('fpNewPassword', this)" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 5px;">
                <svg viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/></svg>
              </button>
            </div>
          </div>
          <div style="margin-bottom: 20px;">
            <label style="display: block; font-weight: 500; margin-bottom: 8px; color: #0a0a0a; font-size: 14px;">Confirm Password</label>
            <div style="position: relative;">
              <input type="password" id="fpConfirmPassword" required style="width: 100%; padding: 12px; padding-right: 45px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; font-family: 'Commissioner', sans-serif;" placeholder="Confirm new password">
              <button type="button" onclick="togglePasswordVisibility('fpConfirmPassword', this)" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; padding: 5px;">
                <svg viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/></svg>
              </button>
            </div>
            <p style="font-size: 12px; color: #777; margin-top: 5px;">Must be at least 6 characters with letters and numbers</p>
          </div>
          <button type="submit" style="width: 100%; padding: 14px; background: #0a0a0a; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 500; cursor: pointer; font-family: 'Commissioner', sans-serif;">Reset Password</button>
        </form>
      </div>
    </div>

    <script>

      function togglePasswordVisibility(inputId, button) {
        const input = document.getElementById(inputId);
        if (input.type === 'password') {
          input.type = 'text';
          button.innerHTML = '<svg viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M11.83,9L15,12.16C15,12.11 15,12.05 15,12A3,3 0 0,0 12,9C11.94,9 11.89,9 11.83,9M7.53,9.8L9.08,11.35C9.03,11.56 9,11.77 9,12A3,3 0 0,0 12,15C12.22,15 12.44,14.97 12.65,14.92L14.2,16.47C13.53,16.8 12.79,17 12,17A5,5 0 0,1 7,12C7,11.21 7.2,10.47 7.53,9.8M2,4.27L4.28,6.55L4.73,7C3.08,8.3 1.78,10 1,12C2.73,16.39 7,19.5 12,19.5C13.55,19.5 15.03,19.2 16.38,18.66L16.81,19.08L19.73,22L21,20.73L3.27,3M12,7A5,5 0 0,1 17,12C17,12.64 16.87,13.26 16.64,13.82L19.57,16.75C21.07,15.5 22.27,13.86 23,12C21.27,7.61 17,4.5 12,4.5C10.6,4.5 9.26,4.75 8,5.2L10.17,7.35C10.74,7.13 11.35,7 12,7Z"/></svg>';
        } else {
          input.type = 'password';
          button.innerHTML = '<svg viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/></svg>';
        }
      }
    </script>
  </body>
</html>
